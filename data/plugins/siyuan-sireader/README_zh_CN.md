<div class="sy__outline" style="max-width: 900px; margin: 0 auto;">
<div style="text-align: center; padding: 2.5em 1.5em; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); border-radius: 16px; box-shadow: 0 8px 32px rgba(0,0,0,0.1); margin-bottom: 2em;">
<h1 style="color: white; margin: 0 0 0.3em; font-size: 2.5em; font-weight: 600;">📖 思阅 SiReader</h1>
<p style="color: rgba(255,255,255,0.9); margin: 0 0 1.5em; font-size: 1.1em;">专业电子书阅读 · 智能标注 · 多格式支持</p>
<p style="color: rgba(255,255,255,0.85); margin: 0 0 1.5em; line-height: 1.6; font-size: 0.95em;">让思源笔记变身专业电子书阅读器，支持 EPUB/PDF/TXT/在线小说多格式阅读<br>提供智能标注、多主题切换、词典查询、AI 翻译、卡包系统等功能，打造沉浸式阅读体验</p>
<p style="margin: 0;">
<img src="https://img.shields.io/badge/version-0.7.0-blue.svg" alt="Version" style="display: inline-block; margin: 0 4px;">
<img src="https://img.shields.io/badge/license-MIT-green.svg" alt="License" style="display: inline-block; margin: 0 4px;">
<img src="https://img.shields.io/badge/SiYuan-3.0+-orange.svg" alt="SiYuan" style="display: inline-block; margin: 0 4px;">
</p>
</div>
</div>

---

## ✨ 核心特性

### 📚 多格式支持
- **EPUB** - 完整支持，智能目录、脚注识别
- **PDF** - 专业阅读器，支持缩放、旋转、搜索
- **TXT** - 智能编码检测，章节自动识别
- **在线小说** - 多书源搜索，实时更新

### 🎨 阅读体验
- **8款主题** - 默认、杏仁黄、秋叶褐、青草绿、海天蓝、夜间、暗黑、赤金
- **自定义主题** - 文字颜色、背景色、背景图片完全自定义
- **阅读模式** - 单页/双页、滚动/翻页、左右目录
- **外观设置** - 字体、字号、行距、段距、边距、视觉滤镜全面可调

### 🖊️ 智能标注
- **7色标注** - 红🔴橙🟠黄🟡绿🟢粉🩷蓝🔵紫🟣，4种样式（高亮/下划线/边框/波浪线）
- **PDF 高级标注** - 墨迹标注、形状标注（矩形/圆形/三角形）、填充功能
- **笔记系统** - 为标注添加详细笔记，支持实时编辑
- **精确定位** - 使用 CFI/页码精确定位，支持跨设备同步

### 📖 词典查询
- **7个词典源** - 剑桥、有道、海词、汉字、词语、汉典、必应
- **智能识别** - 自动选择最合适的词典
- **卡包系统** - 查词结果一键加入卡包，便于复习

### 🔍 书源搜索
- **多书源支持** - 支持自定义书源，并发搜索
- **智能解析** - 完整支持 JSONPath、CSS、XPath、JavaScript、正则表达式
- **规则组合** - 支持 `&&`/`||`/`%%` 组合、`{$.path}` 嵌套、`@put/@get` 数据共享

---

## 🚀 快速开始

### 安装
1. 打开思源笔记 → `设置` → `集市` → `插件`
2. 搜索 "思阅" 或 "SiReader"
3. 点击安装并启用

### 使用
- **本地文件** - 点击书架"添加书籍"按钮，选择 EPUB/PDF/TXT 等文件导入
- **在线小说** - 点击工具栏搜索按钮，搜索并添加到书架
- **书架管理** - 点击工具栏书架按钮，管理所有书籍

---

## 📝 最新更新

### v0.7.0 (2026.1.21)

#### ✨ 新增功能
- **章节显示** - 标注自动显示所属章节，PDF 无目录时显示页码
- **智能分组** - 支持按章节、日期、时间三种方式分组排序，可折叠展开
- **添加时同步** - 新增标注自动导入到绑定的思源文档
- **删除时同步** - 删除标注时同步删除文档中对应的块
- **智能去重** - 自动检测已导入的标注，避免重复导入

#### 🐛 问题修复
- **章节导出** - 修复标注导出链接格式中章节名缺失的问题
- **PDF 页码** - 修复 PDF 无目录时标注缺少位置信息的问题
- **样式过滤** - 修复 EPUB 标注显示 PDF 专属样式（点线、虚线、双线）的问题

#### 🎨 界面优化
- **标注布局** - 章节名与时间并排显示，章节在左，时间在右
- **卡片样式** - 标注卡片样式全面优化，竖条高度仅覆盖第一行
- **按钮位置** - 操作按钮移至右下角，避免遮挡内容
- **笔记样式** - 笔记内容使用斜体显示，视觉层次更清晰
- **分组图标** - 分组折叠使用竖线/圆点切换，交互更直观

---

### v0.6.9 (2026.1.11)

#### ✨ 新增功能
- **标注双向绑定** - 标注导入到思源文档后自动记录块ID，实现标注与文档块的双向关联
- **块跳转** - 已绑定的标注显示链接图标，点击直接跳转到对应的思源文档块
- **悬浮预览** - 鼠标悬停在已绑定标注上，620ms后显示思源原生悬浮预览窗口
- **绑定文档** - 标注/笔记面板新增绑定文档功能，可将书籍标注关联到指定思源文档
- **安娜设置** - 新增安娜的档案设置窗口，支持类型筛选、域名选择和自定义域名

#### 🎨 界面优化
- **导航栏样式** - 优化导航栏样式，更加贴合思源样式
- **图标切换** - 已导入标注的下载图标自动变为链接图标，区分导入状态

#### 🐛 问题修复
- **ZAW3跳转** - 修复zaw3跳转闪烁导致标注遮挡文字的问题

---

### v0.6.8 (2026.1.8)

#### 🐛 问题修复
- **卡包显示** - 修复卡包在书籍未打开时不显示内容的问题
- **书架重复打开** - 优化书架打开书籍逻辑，避免重复打开标签页

#### 🎨 界面优化
- **标签页图标** - 为书籍标签页增加阅读器图标，更容易识别

#### 📝 PDF 标注增强
- **样式扩展** - PDF 标注新增点线、虚线、双线三种样式，与 EPUB 保持一致

#### 📖 TXT 标注优化
- **渲染优化** - 修复标注后其他标注消失的问题，改为只渲染新增标注
- **删除优化** - 修复删除标注后文字也被删除的问题，现在只删除标注样式
- **跳转功能** - 支持点击标注精确跳转到标注位置，不再只跳转到章节开头
- **链接复制** - 修复复制标注时没有生成超链接的问题，现在可以正确复制和跳转

---

### v0.6.7 (2025.12.29)

#### 🎯 交互优化
- **侧边栏统一** - 优化顶部按钮、插件设置按钮点击逻辑，统一打开思阅侧边栏
- **目录快捷访问** - 阅读页面底部控制栏新增目录按钮，点击从底部弹出精致小窗，无需打开侧边栏

#### 🛠️ 界面优化
- **导航栏自适应** - 优化导航栏按钮自适应排布，响应式布局更流畅
- **设置预览增强** - 设置预览新增折叠功能，优化空间利用，实时预览更直观
- **搜索交互** - 优化搜索界面下拉按钮，点击空白处自动隐藏
- **Tooltip 完善** - 统一各界面按钮 tooltip 显示，提示信息更清晰

#### 🐛 问题修复
- **目录滚动** - 修复翻页后目录滚动位置重置的问题
- **侧边栏名称** - 修复侧边栏按钮名称显示为"设置"的问题，统一改为"思阅"
- **封面显示** - 优化部分封面加载失败的显示逻辑

---

## 📖 功能详解

### 🎨 主题系统
8款预设主题适应不同场景，支持自定义主题：
- **默认** - 经典白底黑字
- **杏仁黄** - 护眼配色
- **秋叶褐** - 温暖色调
- **青草绿** - 清新护眼
- **海天蓝** - 宁静平和
- **夜间** - 深色背景
- **暗黑** - 纯黑模式
- **赤金** - 奢华配色

### 🖊️ 标注系统
7种颜色标注，4种样式组合：
- **颜色** - 红🔴橙🟠黄🟡绿🟢粉🩷蓝🔵紫🟣
- **样式** - 高亮、下划线、边框、波浪线
- **笔记** - 为标注添加详细笔记
- **管理** - 按颜色筛选，批量管理

### 📖 词典系统
9个专业词典源，智能识别：
- **AI 翻译** - 免费 AI 翻译（无需配置）、思源 AI 翻译（需配置 OpenAI API）
- **离线词典** - 支持 StarDict (.ifo/.idx/.dict.dz) 和 dictd (.index/.dict.dz) 格式
- **英语词典** - 剑桥（英汉双解、音标、发音、例句）、有道（简洁快速）、海词（例句丰富）
- **中文词典** - 汉字（部首笔画、详细解释）、词语（近反义词、成语典故）、汉典（古汉语查询）
- **通用词典** - 必应（外部网页跳转）

**特色功能：**
- **智能解析** - 自动提取词性、标签、注释、领域、用法等信息
- **长文翻译** - AI 翻译支持长文本和段落翻译，保留格式
- **词典排序** - 支持自定义词典查询顺序
- **离线查询** - 离线词典无需网络，查询速度快
- **音频发音** - 剑桥词典支持美式/英式发音

### 📦 卡包系统
词汇学习和复习：
- **一键加入** - 查词结果一键加入卡包
- **阅读标注** - 卡包词汇在阅读界面显示 🌐 图标
- **实时同步** - 添加/删除后立即更新阅读界面
- **数据持久化** - 存储为 `deck.json` 文件
- **位置记录** - 记录词汇所在书籍、章节、页码位置
- **智能标注** - 卡包词汇自动以紫色高亮显示

### 📚 书架管理
完整的书籍管理系统：
- **多视图** - 网格、列表、简洁三种显示模式
- **智能排序** - 最近添加、最近阅读、阅读进度、书名、作者
- **标签筛选** - 按书籍标签分类筛选
- **进度显示** - 实时显示阅读进度百分比
- **更新检查** - 一键检查所有在线书籍更新
- **元数据解析** - 自动提取书名、作者、简介、章节、封面
- **批量管理** - 支持批量删除、导出书籍

### 🔗 智能跳转
精确定位和跳转：
- **sireader:// 协议** - 支持自定义协议链接
- **CFI 定位** - EPUB 使用 CFI 精确定位
- **页码定位** - PDF 使用页码和矩形坐标定位
- **闪烁提示** - 跳转后高亮闪烁效果
- **智能检测** - 自动检测已打开书籍，直接跳转

### 📱 移动端支持（实验性）
初步支持移动端阅读：
- **手势翻页** - 左右滑动翻页（最小 50px）
- **位置记忆** - 自动保存和恢复阅读位置
- **返回支持** - 监听浏览器返回按钮
- **侧边栏入口** - 移动端侧边栏添加思阅图标

### 🔍 书源系统
强大的规则解析器：
- **JSONPath** - `$.key`、`$[0]`、`$[*]`、`.key` 递归搜索
- **CSS 选择器** - 链式选择、索引过滤、属性提取
- **JavaScript** - `<js>...</js>` 代码块，`result` 变量传递
- **正则表达式** - `##正则##替换` 语法
- **规则组合** - `&&`（与）、`||`（或）、`%%`（交叉合并）

### 🛠️ PDF 工具栏
专业的 PDF 阅读工具：
- **缩放控制** - 放大、缩小、适应宽度、适应页面
- **旋转功能** - 左右旋转 90°
- **工具模式** - 文本选择、手型拖拽
- **墨迹标注** - 7种颜色、粗细调节、橡皮擦、撤销
- **形状标注** - 矩形、圆形、三角形，支持填充
- **文档操作** - 打印、下载、导出图片、查看元数据

### 📊 阅读统计
记录阅读时长：
- **本次阅读** - 当前会话阅读时长
- **今日阅读** - 今天累计阅读时长
- **累计阅读** - 总阅读时长统计
- **状态栏显示** - 实时显示阅读时长
- **自动保存** - 每分钟自动保存统计数据

### 🔗 复制与跳转
智能链接生成：
- **标注复制** - 一键复制标注为思源笔记格式
- **自定义模板** - 支持自定义链接格式
- **形状截图** - 自动生成形状标注截图
- **精确跳转** - 点击链接精确跳转到标注位置
- **闪烁提示** - 跳转后高亮闪烁效果

---

## ⚙️ 设置说明

### 通用设置
- **打开方式** - 新标签、右侧标签、底部标签、新窗口
- **导航栏位置** - 左侧、右侧、顶部、底部
- **目录位置** - 左侧、右侧
- **阅读模式** - 单页、双页、滚动
- **翻页动画** - 滑动、无动画

### 外观设置
- **主题** - 8款预设主题 + 自定义
- **文本** - 字体、字号、字距
- **段落** - 行距、段距、首行缩进
- **布局** - 左右边距、上下边距、列间距
- **视觉** - 亮度、对比度、褐色、饱和度、反色

### 词典设置
- **离线词典** - StarDict/MDict 格式，支持上传、排序、启用/禁用
- **在线词典** - 9个词典源，支持排序、启用/禁用
- **AI 翻译** - 免费 AI（无需配置）、思源 AI（需配置 OpenAI API）
- **词典管理** - 自定义查询顺序，优先查询排在前面的词典

---

## 💡 使用技巧

### 阅读技巧
1. **主题切换** - 白天用默认/杏仁黄，夜晚用夜间/暗黑
2. **阅读模式** - 小说用分页+单页，学术用滚动+双页
3. **快捷键** - ← → 翻页，空格翻页，PageUp/Down 翻页

### 标注技巧
1. **颜色分类** - 红色核心概念，黄色一般重点，绿色正面案例，蓝色补充资料，紫色疑问
2. **标注整理** - 定期在标注模式下回顾
3. **标注导出** - 自动保存到思源笔记文档

### 词典技巧
1. **快速查词** - 双击选中查询
2. **固定窗口** - 点击📌固定词典窗口
3. **多词典对比** - 切换不同词典标签
4. **离线词典** - 下载 StarDict 格式词典，上传后无需网络
5. **AI 翻译** - 支持长文本翻译，自动保留格式和段落
6. **词典排序** - 在词典管理中调整顺序，优先查询常用词典

### PDF 技巧
1. **墨迹标注** - 适合手写批注和圈画重点
2. **形状标注** - 矩形框选、圆形标记、三角形指示
3. **工具栏拖拽** - 长按工具栏按钮可拖动位置
4. **手型工具** - 启用后可拖拽页面，适合大文档浏览

### 书源技巧
1. **并发搜索** - 同时搜索多个书源，快速找书
2. **自定义书源** - 支持导入 JSON 格式书源
3. **规则调试** - 使用浏览器开发者工具测试规则

---

## 🏗️ 技术架构

### 核心模块
- **Foliate.js** - EPUB 渲染引擎，支持 CFI 精确定位
- **PDF.js** - Mozilla 的 PDF 渲染引擎（思源内置）
- **RuleParser** - 多格式书源解析器（JSONPath/CSS/XPath/JS/正则）
- **MarkManager** - PDF/EPUB/TXT 统一标注管理器
- **Bookshelf** - 书籍元数据和进度管理

### 核心特性
- **统一标注** - PDF/EPUB/TXT 使用统一 API
- **智能定位** - EPUB 使用 CFI，PDF 使用页码+矩形，TXT 使用章节
- **实时同步** - 自动保存阅读进度和标注数据
- **卡包集成** - 词汇卡片与阅读界面实时同步
- **移动端支持** - 手势导航和位置记忆

---

## ❓ 常见问题

**Q：EPUB 文件打不开？**  
A：检查文件格式是否为标准 EPUB，确保文件未损坏

**Q：标注没有保存？**  
A：检查标注设置中是否正确配置了笔记本或父文档

**Q：词典查询没反应？**  
A：检查网络连接，部分词典需要联网查询

**Q：AI 翻译失败？**  
A：思源 AI 需要在设置 → AI 中配置 OpenAI API，或使用"AI翻译(免费)"选项

**Q：离线词典无法使用？**  
A：确保上传了完整的词典文件（.ifo/.idx/.dict.dz 或 .index/.dict.dz），并在词典管理中启用

**Q：词典查询结果不准确？**  
A：可以切换不同词典对比，或调整词典查询顺序

**Q：主题切换无效？**  
A：刷新阅读器页面，或重新打开文件

**Q：PDF 标注错位？**  
A：尝试重新缩放或旋转页面，标注会自动重新渲染

**Q：书源搜索失败？**  
A：检查网络连接，部分书源可能失效，可尝试其他书源

**Q：移动端无法翻页？**  
A：确保滑动距离超过 50px，或使用底部翻页按钮

**Q：阅读进度丢失？**  
A：插件会自动保存进度，如遇问题可尝试重新打开书籍

---

## 🙏 致谢

- [思源笔记](https://github.com/siyuan-note/siyuan) - 优秀的插件开发框架
- [Foliate.js](https://github.com/johnfactotum/foliate-js) - 强大的 EPUB 渲染引擎
- [PDF.js](https://github.com/mozilla/pdf.js) - Mozilla 的 PDF 渲染引擎
- [归叶插件](https://github.com/Wetoria) - Vue3 + Vite 插件模板

---

## 📄 开源协议

本项目采用 [MIT](LICENSE) 协议开源

---

<div align="center">

**开发理念**：极简 · 高效 · 优雅 · 完美

Made with ❤️ by SiReader Team

</div>
